<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="false"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Timer and LED Driver &middot; Fadlan Abduh</title>
    <meta name="title" content="Timer and LED Driver &middot; Fadlan Abduh">
  

  
  
    <meta name="description" content="Going low-level.">
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/posts/avr/02-max7219/">
  

  
  
    <meta name="author" content="Fadlan Abduh">
  
  

  
  <meta property="og:url" content="http://localhost:1313/posts/avr/02-max7219/">
  <meta property="og:site_name" content="Fadlan Abduh">
  <meta property="og:title" content="Timer and LED Driver">
  <meta property="og:description" content="Going low-level.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-24T13:00:00+07:00">
    <meta property="article:modified_time" content="2026-01-24T13:00:00+07:00">
      <meta property="og:see_also" content="http://localhost:1313/posts/avr/01-shift-register/">
      <meta property="og:see_also" content="http://localhost:1313/posts/avr/00-hello/">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Timer and LED Driver">
  <meta name="twitter:description" content="Going low-level.">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
    
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.28be18702a02b0b5ac6b7155d437b07f091a677af2b3c5730aae30a87587bfd0e278a9499515c271154afa012bc1aaf5625e415c6aeabfe292242a2bf55fc388.css"
    integrity="sha512-KL4YcCoCsLWsa3FV1DewfwkaZ3rys8VzCq4wqHWHv9DieKlJlRXCcRVK&#43;gErwar1Yl5BXGrqv&#43;KSJCor9V/DiA==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9df4fc14d50efcc9aa4cfc2b6f348e365f421f5ad491278f8f48c0360cf2f93f08882fda6da162d7ace8e5add57c2df4ac46bd3861306b1d4c452cd31f448d64.js"
      integrity="sha512-nfT8FNUO/MmqTPwrbzSONl9CH1rUkSePj0jANgzy&#43;T8IiC/abaFi16zo5a3VfC30rEa9OGEwax1MRSzTH0SNZA=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>









  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/lib/katex/katex.min.9e578d7ac3b5270b37ae32edae7835a744cda7734036e6e2f1ccf16f382b056ccd51c0df6b7ef3470991357a026507840aa22c1740ea2fe6bbce9b4223c5c182.css"
    integrity="sha512-nleNesO1Jws3rjLtrng1p0TNp3NANubi8czxbzgrBWzNUcDfa37zRwmRNXoCZQeECqIsF0DqL&#43;a7zptCI8XBgg==">
  
  
  
  <script
    defer
    type="text/javascript"
    src="/js/katex.bundle.a10a4a0655682a978b0422e48a40f3515d4d96c8e600a48e3dad34029a55cc00b128b89a908855227d1c07897ce09cdfe9f0d57decb148cb73f17dbb8a0a715c.js"
    integrity="sha512-oQpKBlVoKpeLBCLkikDzUV1NlsjmAKSOPa00AppVzACxKLiakIhVIn0cB4l84Jzf6fDVfeyxSMtz8X27igpxXA=="
    id="katex-render"></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  













  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/lib/lite-youtube-embed/lite-yt-embed.badabc6055b427669bbcf084097334cdf2029c85696c4a56e25239825d3571d26ef82b775ba19032ccd52135ccb412c9ba79da4e9e9b6f3939a6178a5f65ee5d.css"
    integrity="sha512-utq8YFW0J2abvPCECXM0zfICnIVpbEpW4lI5gl01cdJu&#43;Ct3W6GQMszVITXMtBLJunnaTp6bbzk5pheKX2XuXQ==">
  
  
  <script
    type="text/javascript"
    src="/lib/lite-youtube-embed/lite-yt-embed.58a8a22aed9d1cd05780869df4b0d87972fcd144a9eaff8f9a1453e58e6521c5a89ccd80bdb9f48e25ae5ee87b98bd9de51b14dd9988c60e4c89630433292084.js"
    integrity="sha512-WKiiKu2dHNBXgIad9LDYeXL80USp6v&#43;PmhRT5Y5lIcWonM2Avbn0jiWuXuh7mL2d5RsU3ZmIxg5MiWMEMykghA=="></script>






  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Timer and LED Driver",
    "headline": "Timer and LED Driver",
    
    
    "inLanguage": "en",
    "url" : "http://localhost:1313/posts/avr/02-max7219/",
    "author" : {
      "@type": "Person",
      "name": "Fadlan Abduh"
    },
    "copyrightYear": "2026",
    "dateCreated": "2026-01-24T13:00:00\u002b07:00",
    "datePublished": "2026-01-24T13:00:00\u002b07:00",
    
    "dateModified": "2026-01-24T13:00:00\u002b07:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "3256"
  }]
  </script>



  
  

  
  

  
  

  
  

  
  
</head>


















  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 z-100">
  <div
    id="menu-blur"
    class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32">
    













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium">
          Fadlan Abduh
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/posts/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Blog"
  title="Posts">
  
  
    <p class="text-base font-medium">
      Blog
    </p>
  
</a>



      
        
  <a
  href=""
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  
  title="">
  
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Blog"
    title="Posts">
    
    
      <p class="text-bg font-bg">
        Blog
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    
    title="">
    
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





  </div>
</div>


<script
  type="text/javascript"
  src="/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js"
  integrity="sha512-AKV8c&#43;oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ&#43;pkPSYl5ixQYmehaQ=="
  data-blur-id="menu-blur"></script>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Timer and LED Driver
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2026-01-24T13:00:00&#43;07:00">24 January 2026</time><span class="px-2 text-primary-500">&middot;</span><span>3256 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">16 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Fadlan Abduh
      </div>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400">Messing aroud with ones and zeros.</div>
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      


      <div class="min-w-0 min-h-0 max-w-fit">
        
  <details
    class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5"
    >
    
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">
    AVR -
    This article is part of a series.
  </summary>
  
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/avr/00-hello/">
          Part 0:
          Hello, Bare Metal AVR.
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/avr/01-shift-register/">
          Part 1:
          Animating LEDs with Shift Register
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        Part 2:
        This Article
      </div>
    
  


  </details>


        <div class="article-content max-w-prose mb-20">
          
<h2 class="relative group">Table of Contents
    <div id="table-of-contents" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#table-of-contents" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ol>
<li><a
  href="#intro---objective">Intro - Objective</a></li>
<li><a
  href="#timer">Timer</a><br>
a. <a
  href="#do-the-math">↳ Do The Math</a><br>
b. <a
  href="#registers">↳ Registers</a><br>
c. <a
  href="#button-debouncing">↳ Button Debouncing</a></li>
<li><a
  href="#max7219-led-display-driver">MAX7219 LED Display Driver</a><br>
a. <a
  href="#overview">↳ Overview</a><br>
b. <a
  href="#serial-peripheral-interface-spi-protocol">↳ Serial Peripheral Interface (SPI) Protocol</a><br>
c. <a
  href="#registers-map">↳ Registers Map</a><br>
d. <a
  href="#daisy-chaining">↳ Daisy Chaining</a></li>
<li><a
  href="#show-something">Show Something</a><br>
a. <a
  href="#8-digit-7-segment-led">↳ 8 Digit 7-Segment LED</a><br>
b. <a
  href="#8x8-led-matrix">↳ 8x8 LED Matrix</a></li>
<li><a
  href="#result">Result</a></li>
<li><a
  href="#conclusion">Conclusion</a></li>
<li><a
  href="#references-and-further-reading">References and Further Reading</a></li>
</ol>

<h2 class="relative group">Intro - Objective
    <div id="intro---objective" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#intro---objective" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Pada blog teknikal kali kini, kita akan mencoba menjadikan mikrokontroler ATMega328P sebagai otak dari jam digital. Jam digital akan ditampilkan dalam format 8 digit: <code>HH.MM.SS.cc</code> dengan <code>c</code> adalah <em>centiseconds</em>.</p>
<p>Untuk menampilkan waktu, digunakan modul display 7 segment dengan MAX7219 sebagai drivernya. Selain itu, digunakan pula display matrix 8x8 dengan driver yang sama untuk tantangan semata.</p>
<p>Matrix 8x8 akan menampilkan beberapa emoji/karakter, angka, huruf kapital, dan huruf kecil. Untuk mengganti tampilan, digunakan dua tombol: prev dan next.</p>
<p>Pada jam digital, ditambahkan mekanisme &ldquo;hold&rdquo; yang akan menghentikan waktu (display) selama tombol masih ditekan.</p>
<p>Program akan dibahas secara runtut dari program utama timer, debouncing button, hingga interface MAX7219. Kita akan menggunakan beberapa konsep C seperti pointers, reference, dan struct, pastikan Anda telah memahaminya.</p>

<h2 class="relative group">Timer
    <div id="timer" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#timer" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Secara umum, timer adalah periferal pada mikrokontroler yang berguna untuk menghitung sinyal clock. Timer dSecara umum, timer adalah periferal pada mikrokontroler yang berguna untuk menghitung sinyal clock. Timer dapat dikonfigurasi sedemikian rupa, sehingga perhitungannya dapat digunakan untuk mengukur waktu, delay, dan lain lain.
apat dikonfigurasi sedemikian rupa, sehingga perhitungannya dapat digunakan untuk mengukur waktu, delay, dan lain lain.</p>
<p>Timer bekerja dengan melakukan increment/decrement nilai register setiap beberapa interval. Batas bilangan dan interval dapat dikonfigurasi.</p>
<p>Mikrokontroler ATMega328P dibekali dengan tiga buah timer: timer0 8-bit, timer1 16-bit, dan timer2 8-bit. Kita akan menggunakan timer1 16-bit untuk mengukur waktu dan melakukan button debouncing.</p>
<p>Timer ini memiliki beberapa mode utama: normal, pwm (pulse width modulation), ctc (clear timer compare match). Pada mode ini, timer akan melakukan increment pada register <code>TCNT1H</code> dan <code>TCNT1L</code>*. Kemudian membandingkan nilai kedua register tersebut dengan register pembanding yang kita konfigurasi.</p>
<p>Ketika nilainya cocok (match), register <code>TCINT1H</code> dan <code>TCINT1L</code> akan direset ke nilai 0. Jika kita mengaktifkan interrupt, ISR akan dijalankan.</p>
<p><em>*Catatan: <code>TCNTH</code> untuk byte 8-15 dan <code>TCNT1L</code> untuk byte 0-7.</em></p>

<h3 class="relative group">Do The Math
    <div id="do-the-math" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#do-the-math" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Unit waktu terkecil pada jam yang akan dibuat adalah 1 centisecond:


</p>
$$
  1\text{ s} = 100\text{ cs} = 1,000\text{ ms} = 1,000,000\text{ μs} = 1,000,000,000\text{ ns}
$$<p>Unit <code>centiseconds</code> dijadikan sebagai variable global volatile yang nilainya diincrement setiap 10ms oleh ISR timer 1. Kita perlu mengkonfigurasi timer1 untuk menjalankan ISR setiap 10ms. Sebelum itu, kita hitung terlebih dahulu berapa lama durasi 1 clock cycle.


</p>
$$
f_{CPU} = 16\text{ MHz} = 16,000,000\text{ clock cycles/s}
$$<p>
</p>
$$
T = \frac{1,000,000,000\text{ ns}}{16,000,000\text { ticks}} = 62.5\text{ ns/cycle}
$$<p>
</p>
$$
\frac{10\text{ ms}}{62.5\text{ ns}} = \frac{10,000,000\text{ ns}}{62.5\text{ ns}} = 160,000\text{ clock cycles}
$$<p>

Butuh 160.000 clock cycle untuk mencapai durasi 10ms jika frekuensi yang digunakan adalah 16MHz. Angka ini terlalu besar untuk timer1 yang hanya 16-bit, \(2^{16} = 65,536\).</p>
<p>Untuk mengatur frekuensi timer ATMega328P, dapat diterapkan sebuah prescale. Yakni membagi frekuensi CPU dengan suatu bilangan. Pada timer 1, frekuensi dapat dibagi dengan \(1, 8, 64, 256,\) atau \(1,024\).</p>
<p>Perlu diingat bahwa prescale pada timer tidak akan memengaruhi frekuensi utama CPU. Untuk kejelasan, <code>tick</code> merepresentasikan 1 clock cycle pada timer, bukan frekuensi utama CPU.</p>
<p>

</p>
$$
\frac{16\text{ MHz}}{8} = 2\text{ MHz} = 2,000,000\text{ ticks/s} = \frac{2,000,000\text{ ticks}}{1,000,000,000\text{ ns}}
$$<p>
</p>
$$
T_{tick} = \frac{1,000,000,000\text{ ns}}{2,000,000\text { ticks}} = 500\text{ ns}
$$<p>
</p>
$$
\frac{10\text{ ms}}{500\text{ ns}} = \frac{10,000,000\text{ ns}}{500\text{ ns}} = 20,000\text{ ticks}
$$<p>Sekarang kita tahu bahwa untuk mencapai 10ms dibutuhkan 20.000 tick timer1, jika frekuensi timer1 dibagi 8. 19.999 (hitung dari 0) akan menjadi nilai pembanding timer1 untuk menjalankan ISR, sehingga ISR dijalankan setiap 10ms.</p>

<h3 class="relative group">Registers
    <div id="registers" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#registers" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="TCCR1A"
    width="1106"
    height="202"
    src="/posts/avr/02-max7219/img/tccr1a_hu_2d6a42ea5903bb1f.png"
    srcset="/posts/avr/02-max7219/img/tccr1a_hu_2d6a42ea5903bb1f.png 800w, /posts/avr/02-max7219/img/tccr1a.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/tccr1a.png"></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="TCCR1B"
    width="1106"
    height="202"
    src="/posts/avr/02-max7219/img/tccr1b_hu_852e42a48a502e3e.png"
    srcset="/posts/avr/02-max7219/img/tccr1b_hu_852e42a48a502e3e.png 800w, /posts/avr/02-max7219/img/tccr1b.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/tccr1b.png"></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="WGM"
    width="1184"
    height="804"
    src="/posts/avr/02-max7219/img/wgmr_hu_b5e49beee93e012.png"
    srcset="/posts/avr/02-max7219/img/wgmr_hu_b5e49beee93e012.png 800w, /posts/avr/02-max7219/img/wgmr.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/wgmr.png"></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="CS"
    width="1193"
    height="572"
    src="/posts/avr/02-max7219/img/clock-selectr_hu_d80888632b180a83.png"
    srcset="/posts/avr/02-max7219/img/clock-selectr_hu_d80888632b180a83.png 800w, /posts/avr/02-max7219/img/clock-selectr.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/clock-selectr.png"></figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">TCCR1B</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="n">b010</span><span class="p">;</span>
</span></span></code></pre></div><p><code>(1 &lt;&lt; 3)</code> akan mengaktifkan mode CTC dengan nilai <code>OCR1A</code> sebagai nilai pembanding (Table 15-5). Dan <code>| 0b010</code> akan mengaktifkan prescale 8 (Table 15-6).</p>
<p>Setelah timer 1 dikonfigurasi, kita masih perlu membandingkan nilai <code>TCINT1</code> dengan <code>19999</code>.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="OCR1AB Register"
    width="1290"
    height="637"
    src="/posts/avr/02-max7219/img/ocr1ab_hu_9dd65cf60b36f1fb.png"
    srcset="/posts/avr/02-max7219/img/ocr1ab_hu_9dd65cf60b36f1fb.png 800w, /posts/avr/02-max7219/img/ocr1ab_hu_d32c3385c9dbbe56.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/ocr1ab.png"></figure>
<p><code>OCR1A</code> atau <code>OCR1B</code> cocok dengan kebutuhan kita. Untuk mengaktifkan interrupt ketika nilai <code>OCR1A</code> dan <code>TCINT1</code> cocok, register <code>TIMSK</code> harus diubah.</p>
<p><figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="TIMSK"
    width="1281"
    height="228"
    src="/posts/avr/02-max7219/img/timsk1_hu_7f8a5b178e2a770d.png"
    srcset="/posts/avr/02-max7219/img/timsk1_hu_7f8a5b178e2a770d.png 800w, /posts/avr/02-max7219/img/timsk1_hu_12c2fff87d131af2.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/timsk1.png"></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="OCIE1A"
    width="1214"
    height="152"
    src="/posts/avr/02-max7219/img/ociea1_hu_e30d538b5cc8e743.png"
    srcset="/posts/avr/02-max7219/img/ociea1_hu_e30d538b5cc8e743.png 800w, /posts/avr/02-max7219/img/ociea1.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/ociea1.png"></figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">TCCR1B</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="n">b010</span><span class="p">;</span> <span class="c1">// ctc mode, presale 8 (2 MHz)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">OCR1A</span> <span class="o">=</span> <span class="mi">19999</span><span class="p">;</span> <span class="c1">// 10ms each match
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">TIMSK1</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">OCIE1A</span><span class="p">);</span> <span class="c1">// Enable compare match A interrupt
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>Dengan konfigurasi timer di atas, sinyal interrupt vector TIMER1_COMPA akan dihasilkan setiap 10ms. Di dalam ISR kita dapat melakukan increment variabel <code>centiseconds</code>, dan mengaktifkan flag <code>update_display</code>.</p>
<p>Flag <code>update_display</code> digunakan agar driver tidak terlalu banyak bekerja. Frekuensi maksimal yang dapat ditanggung IC <code>MAX7219</code> adalah 800Hz. Dengan update setiap 10ms, maka frekuensinya adalah 100Hz.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">volatile</span> <span class="kt">uint32_t</span> <span class="n">centiseconds</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">volatile</span> <span class="kt">bool</span> <span class="n">count</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">volatile</span> <span class="kt">bool</span> <span class="n">update_display</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">ISR</span> <span class="p">(</span><span class="n">TIMER1_COMPA_vect</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">centiseconds</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">update_display</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>Variabel boolean <code>count</code> ditentukan oleh sebuah tombol, ketika ditahan nilainya false. Terdapat dua tombol lain <code>prev</code> dan <code>next</code>, yang  berfungsi untuk mengganti tampilan matrix 8x8.</p>
<p>Alih-alih menggunakan PCINT (Pin Change Interrupt) atau EINT (External Interrupt), kita akan menggunakan ISR yang sudah ada.</p>

<h3 class="relative group">Button Debouncing
    <div id="button-debouncing" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#button-debouncing" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Pada program sebelumnya, kita menggunakan <code>_delay_ms(25)</code> di dalam ISR untuk melakukan debouncing pada sebuah tombol. Namun, ISR harus diselesaikan dalam clock cycle seminimal mungkin. Fungsi delay melanggar aturan tersebut.</p>
<blockquote>
<p>Generally it is never recommended to use a delay routine inside the
ISR. ~AVR1200: Using External Interrupts for megaAVR
Devices, ATMEL Application Notes</p></blockquote>
<p>Sebagai alternatif, kita dapat menggunakan ISR timer yang sudah kita buat untuk mengecek keadaan tiga tombol setiap 10ms.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define BUTTON_COUNT 3
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">inputreg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="n">pin_no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">bool</span> <span class="n">last_state</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="n">delay</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">bool</span> <span class="n">event</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="kt">button_t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">volatile</span> <span class="kt">button_t</span> <span class="n">hold</span><span class="p">;</span> <span class="c1">// PD2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">volatile</span> <span class="kt">button_t</span> <span class="n">next</span><span class="p">;</span> <span class="c1">// PD6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">volatile</span> <span class="kt">button_t</span> <span class="n">prev</span><span class="p">;</span> <span class="c1">// PD7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">volatile</span> <span class="kt">button_t</span> <span class="o">*</span><span class="n">buttons</span><span class="p">[</span><span class="n">BUTTON_COUNT</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">&amp;</span><span class="n">hold</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="o">&amp;</span><span class="n">next</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="o">&amp;</span><span class="n">prev</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">button_t</span> <span class="nf">init_button</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="n">inputreg</span><span class="p">,</span> <span class="kt">char</span> <span class="n">pin_no</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">button_t</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">temp</span><span class="p">.</span><span class="n">inputreg</span> <span class="o">=</span> <span class="n">inputreg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">temp</span><span class="p">.</span><span class="n">pin_no</span> <span class="o">=</span> <span class="n">pin_no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">temp</span><span class="p">.</span><span class="n">last_state</span> <span class="o">=</span> <span class="p">((</span><span class="o">*</span><span class="n">inputreg</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">pin_no</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">temp</span><span class="p">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">temp</span><span class="p">.</span><span class="n">event</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Karena ketiga tombol memiliki karakteristik/parameter yang sama, kita dapat memanfaatkan struct.</p>
<p>Array <code>*buttons</code> akan diiterasi di dalam ISR. Masing-masing elemen array tersebut menunjuk ke alamat memori sebuah struct <code>button_t</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">hold</span> <span class="o">=</span> <span class="nf">init_button</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PIND</span><span class="p">,</span> <span class="n">PD2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">next</span> <span class="o">=</span> <span class="nf">init_button</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PIND</span><span class="p">,</span> <span class="n">PD6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">prev</span> <span class="o">=</span> <span class="nf">init_button</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PIND</span><span class="p">,</span> <span class="n">PD7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">PORTD</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">hold</span><span class="p">.</span><span class="n">pin_no</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">next</span><span class="p">.</span><span class="n">pin_no</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">prev</span><span class="p">.</span><span class="n">pin_no</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>Pemanggilan fungsi <code>init_button</code> di dalam main akan menginisialisasi struct <code>button_t</code>. Ketiga tombol di atas merupakan pull-up button, sehingga nilai <code>last_state</code> adalah 1, dan kita perlu memberi nilai HIGH pada <code>PORTD</code>.</p>
<p>Karena alamat ketiga variabel di atas disimpan dalam sebuah array, kita dapat menggunakan <code>for</code> loop di dalam ISR untuk mengecek keadaan setiap tombol:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define DEBOUNCE_DELAY 3
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nf">ISR</span> <span class="p">(</span><span class="n">TIMER1_COMPA_vect</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">centiseconds</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">update_display</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">BUTTON_COUNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">current_state</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">inputreg</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">pin_no</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">current_state</span> <span class="o">!=</span> <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">last_state</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">delay</span><span class="o">&gt;=</span><span class="n">DEBOUNCE_DELAY</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">event</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">last_state</span> <span class="o">=</span> <span class="n">current_state</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">delay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">delay</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">update_display</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">delay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Di setiap iterasinya, jika kondisi tombol saat ini berbeda dengan kondisi terakhir, nilai member <code>delay</code> akan di-increment. Ini akan terjadi sebanyak tiga kali setiap ISR dijalankan, yakni setiap 10ms.
Dengan begitu, durasi total debounce adalah 30ms.</p>
<p>Setelah nilai <code>delay</code> &gt;= 3, flag <code>event</code> akan diaktifkan, keadaan terakhir diperbarui, dan <code>delay</code> diulang ke 0. Flag <code>event</code> nantinya digunakan pada <em>main loop</em> untuk menjalankan aksi yang diperlukan.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">extern</span> <span class="kt">uint8_t</span> <span class="n">IMAGES_LEN</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">volatile</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">hold</span><span class="p">.</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="n">hold</span><span class="p">.</span><span class="n">inputreg</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">hold</span><span class="p">.</span><span class="n">pin_no</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">hold</span><span class="p">.</span><span class="n">event</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">next</span><span class="p">.</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="n">next</span><span class="p">.</span><span class="n">inputreg</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">next</span><span class="p">.</span><span class="n">pin_no</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">==</span><span class="p">(</span><span class="n">IMAGES_LEN</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">c</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">next</span><span class="p">.</span><span class="n">event</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">prev</span><span class="p">.</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="o">*</span><span class="p">(</span><span class="n">prev</span><span class="p">.</span><span class="n">inputreg</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">prev</span><span class="p">.</span><span class="n">pin_no</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">c</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">c</span> <span class="o">=</span> <span class="n">IMAGES_LEN</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">prev</span><span class="p">.</span><span class="n">event</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Tidak lupa, setelah aksi, member <code>event</code> dikembalikan ke nilai <code>false</code>.</p>
<p>Sistem debounce di atas tidak menggunakan fungsi <em>blocking</em> <code>_delay_ms</code> yang akan memblokir semua proses dalam periode tertentu. Alih-alih, ISR timer yang sudah dikonfigurasi digunakan untuk mengecek keadaan masing-masing tombol dan melakukan delay <em>non-blocking</em>. Karena merupakan proses <em>non-blocking</em>, display waktu tidak akan terhambat oleh proses debounce.</p>

<h2 class="relative group">MAX7219 LED Display Driver
    <div id="max7219-led-display-driver" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#max7219-led-display-driver" aria-label="Anchor">#</a>
    </span>
    
</h2>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="7 Segment and 8x8 Matrix Displays"
    width="960"
    height="811"
    src="/posts/avr/02-max7219/img/7seg-8x8-displays_hu_432b072886eecc74.png"
    srcset="/posts/avr/02-max7219/img/7seg-8x8-displays_hu_432b072886eecc74.png 800w, /posts/avr/02-max7219/img/7seg-8x8-displays.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/7seg-8x8-displays.png"><figcaption>Modul display 7 segment dan 8x8 matrix dengan driver MAX7219.</figcaption></figure>
<blockquote>
<p>The MAX7219/MAX7221 are compact, serial input/
output common-cathode display drivers that interface
microprocessors (μPs) to 7-segment numeric LED
displays of up to 8 digits, bar-graph displays, or 64 individual
LEDs. Included on-chip are a BCD code-B decoder,
multiplex scan circuitry, segment and digit drivers, and
an 8x8 static RAM that stores each digit. Only one
external resistor is required to set the segment current for
all LEDs. ~MAX7219/MAX7221 Datasheet</p></blockquote>

<h3 class="relative group">Overview
    <div id="overview" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#overview" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Kita akan menggunakan modul 7-segment untuk menampilkan waktu, dan modul 8x8 matrix untuk menampilkan karakter.</p>
<p>Pada modul 7-segment 8 digit, terdapat 8 LED untuk masing-masing digit (termasuk titik), \(8 × 8 = 64\). Modul display 8x8 matrix juga memiliki jumlah LED yang sama, 64. Total, terdapat 128 LED yang perlu dikendalikan. Jumlah yang terlalu banyak jika hanya dikendalikan oleh ATMega328P.</p>
<p>Oleh karena itu, IC MAX7219 digunakan sebagai <em>display driver</em>. Satu unit IC ini dapat mengendalikan 8 digit 7 segment, atau 64 LED. IC ini bekerja menggunakan teknik multiplexing. Yakni mengendalikan satu digit dalam satu waktu, dan beralih ke digit lainnya dengan sangat cepat sehingga tercipta ilusi bahwa semua digit tampil secara bersamaan.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="7 Segment Multiplexing"
    width="1688"
    height="630"
    src="/posts/avr/02-max7219/img/7segment_multiplexing_hu_11b0b6a75e4119c5.gif"
    srcset="/posts/avr/02-max7219/img/7segment_multiplexing_hu_11b0b6a75e4119c5.gif 800w, /posts/avr/02-max7219/img/7segment_multiplexing_hu_6709f78a21978d42.gif 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/7segment_multiplexing.gif"><figcaption>Scanning by columns at fast-enough frequencies cause the number &lsquo;1.234&rsquo; to appear static, due to the persistence of vision optical illusion. Source: Wikipedia.org</figcaption></figure>
<p>Untuk alasan kemudahan, kita menggunakan modul display yang sudah tertanam IC MAX7219.</p>

<h3 class="relative group">Pinout Description
    <div id="pinout-description" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#pinout-description" aria-label="Anchor">#</a>
    </span>
    
</h3>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="8x8 Matrix Pinout"
    width="874"
    height="420"
    src="/posts/avr/02-max7219/img/8x8matrix-pinout_hu_f176bb2c4773d22b.png"
    srcset="/posts/avr/02-max7219/img/8x8matrix-pinout_hu_f176bb2c4773d22b.png 800w, /posts/avr/02-max7219/img/8x8matrix-pinout.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/8x8matrix-pinout.png"><figcaption>Display Module Pinout</figcaption></figure>
<p>Karena kedua modul menggunakan IC yang sama, pinout kedua modul juga sama. Di sebelah kiri adalah in, sebalah kanan out.</p>
<p>Pin <code>DIN</code> dan <code>CLK</code> digunakan untuk protokol komunikasi <em>Serial Peripheral Interface (SPI)</em>. Pin <code>CS</code> akan memperbarui display ketika diberi sinyal <em>rising edge</em>.</p>
<p>Sinyal output di sebelah kanan berguna untuk merantai (<em>daisy chaining</em>) beberapa modul display. Contoh, <code>DOUT</code> dari modul A disambungkan ke <code>DIN</code> dari modul B. Dengan ini, jumlah pin yang terhubung ke MCU tetaplah sama.</p>
<p>Modul yang dirantai tidak harus memiliki jenis tampilan yang seragam, selama IC yang digunakan sama, MAX7219. Pada kasus kita, modul 7-segment 8 digit akan dihubungkan ke MCU, dan <code>DOUT</code> dari modul tersebut dirantai ke modul 8x8 matrix.</p>

<h3 class="relative group">Serial Peripheral Interface (SPI) Protocol
    <div id="serial-peripheral-interface-spi-protocol" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#serial-peripheral-interface-spi-protocol" aria-label="Anchor">#</a>
    </span>
    
</h3>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="SPI Master Slave"
    width="2330"
    height="998"
    src="/posts/avr/02-max7219/img/spi-maslave_hu_cbe7621dd5a54b7c.png"
    srcset="/posts/avr/02-max7219/img/spi-maslave_hu_cbe7621dd5a54b7c.png 800w, /posts/avr/02-max7219/img/spi-maslave_hu_223edce5c359bb8e.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/spi-maslave.png"><figcaption>SPI Master-Slave Interconnection</figcaption></figure>
<p>Serial Peripheral Interface (SPI) adalah protokol komunikasi serial synchronous, yang berarti mengirimkan data secara serial dengan clock yang tersinkronisasi. Protokol ini menggunakan arsitektur master-slave seperti yang terlihat pada gambar di atas. Dalam hal ini, ATMega328P berperan sebagai master, dan dua modul MAX7219 sebagai slave.</p>
<p>Dapat diperhatikan pada sisi master dan slave, masing-masing terdapat 8-bit shift register. Pada blog sebelumnya, kita mencoba &ldquo;mengisi&rdquo; shift register dengan menyala-matikan tiga buah pin: <code>SER</code>, <code>SCLK</code>, <code>RCLK</code>.</p>
<p>Kali ini, kita tidak perlu mengisi shift register master secara manual. Mikrokontroler ATMega328P sudah dilengkapi dengan peripheral SPI. Sehingga kita cukup mengkonfigurasi periferal tersebut satu kali, dan mengisi shift register seperti mengisi variabel.</p>
<p>Perlu dicatat bahwa protokol SPI memiliki variasi yang cukup banyak, sehingga konfigurasi perangkat satu dengan lainnya mungkin berbeda. Secara umum, terdapat empat jalur utama pada protokol SPI:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Kode</th>
          <th style="text-align: left">Kepanjangan</th>
          <th style="text-align: left">Arah</th>
          <th style="text-align: left">Deskripsi</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">SCK</td>
          <td style="text-align: left">Serial Clock</td>
          <td style="text-align: left">Master -&gt; Slave</td>
          <td style="text-align: left">Dikirim oleh master untuk mensinkronkan transfer data</td>
      </tr>
      <tr>
          <td style="text-align: left">MOSI</td>
          <td style="text-align: left">Master Out Slave In</td>
          <td style="text-align: left">Master -&gt; Slave</td>
          <td style="text-align: left">Data dari master ke slave</td>
      </tr>
      <tr>
          <td style="text-align: left">MISO</td>
          <td style="text-align: left">Master In Slave Out</td>
          <td style="text-align: left">Slave -&gt; Master</td>
          <td style="text-align: left">Data dari slave ke master</td>
      </tr>
      <tr>
          <td style="text-align: left">SS/CS</td>
          <td style="text-align: left">Slave Select / Chip Select</td>
          <td style="text-align: left">Master -&gt; Slave</td>
          <td style="text-align: left">Untuk memilih slave mana yang aktif</td>
      </tr>
  </tbody>
</table>
<p>IC MAX7219 tidak memiliki pin <code>SS/CS</code>, hanya ada pin <code>LOAD</code>. Data yang disimpan pada shift register MAX7219 akan di-<em>latch</em> ketika <code>LOAD</code> diberi sinyal <em>rising edge</em>. Ini membuat MAX7219 tidak bisa dianggap sepenuhnya &ldquo;SPI&rdquo;. Namun, kita masih bisa menangani pin <code>LOAD</code> secara manual.</p>
<p>Berhubung MAX7219 adalah modul driver display (output), pin MISO tidak digunakan di sini. Pada jalur MOSI, bit pertama yang dikirim adalah bit paling signifikan (MSB first).</p>
<p><figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="SPI Control Register"
    width="1424"
    height="1121"
    src="/posts/avr/02-max7219/img/spcr_hu_8de00ca4cb95912c.png"
    srcset="/posts/avr/02-max7219/img/spcr_hu_8de00ca4cb95912c.png 800w, /posts/avr/02-max7219/img/spcr_hu_c2ee82c384c91b17.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/spcr.png"><figcaption>SPI Control Register</figcaption></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="SPCR Clock Phase"
    width="1366"
    height="357"
    src="/posts/avr/02-max7219/img/spcr-cpha_hu_712fdd96f37f507b.png"
    srcset="/posts/avr/02-max7219/img/spcr-cpha_hu_712fdd96f37f507b.png 800w, /posts/avr/02-max7219/img/spcr-cpha_hu_985560965c0f8cc2.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/spcr-cpha.png"><figcaption>SPCR Clock Phase</figcaption></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="SPI Status Register"
    width="1360"
    height="668"
    src="/posts/avr/02-max7219/img/spsr_hu_cffbdc869b9ab6da.png"
    srcset="/posts/avr/02-max7219/img/spsr_hu_cffbdc869b9ab6da.png 800w, /posts/avr/02-max7219/img/spsr_hu_f85e837efdd148f3.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/spsr.png"><figcaption>SPI2x, SPR1, SPR0</figcaption></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="MAX7219 Timing Diagram"
    width="1398"
    height="522"
    src="/posts/avr/02-max7219/img/max7219-timing-diagram_hu_3f02f65a36257057.png"
    srcset="/posts/avr/02-max7219/img/max7219-timing-diagram_hu_3f02f65a36257057.png 800w, /posts/avr/02-max7219/img/max7219-timing-diagram_hu_6cb7f30e17a73b8.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/max7219-timing-diagram.png"><figcaption>MAX7219 Timing Diagram</figcaption></figure>
</p>
<p>Terdapat banyak opsi konfigurasi yang dapat diubah, kita akan mengikuti datasheet MAX7219 dan kebutuhan untuk konfigurasi SPI:</p>
<ol>
<li><code>SPIE = 0</code>, tidak butuh.</li>
<li><code>SPE = 1</code>, perlu dinyalakan untuk menggunakan SPI.</li>
<li><code>DORD = 0</code>, MSB first.</li>
<li><code>MSTR = 1</code>, MCU sebagai master.</li>
<li><code>CPOL = 0</code>, idle low sesuai timing diagram.</li>
<li><code>CPHA = 0</code>, sample diambil pada rising/leading edge clock.</li>
<li><code>SPR1:0 = 0</code>, MAX7219 mampu menghandle SCK sampai 10 MHz.</li>
<li><code>SPI2X = 1</code>, 16MHz/2 = 8MHz.</li>
</ol>
<p>Tidak lupa kita perlu mengatur pin <code>SCK</code>, <code>MOSI</code>, dan <code>LOAD</code> sebagai output. Pada ATMega328P, pin <code>SCK = PB5</code>, <code>MOSI = PB3</code>, dan pin <code>LOAD = PB2</code>. Pin <code>LOAD</code> dapat menggunakan pin manapun karena kita mengontrolnya secara manual.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">SPI_init</span><span class="p">(</span><span class="kt">int</span> <span class="n">sck</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mosi</span><span class="p">,</span> <span class="kt">int</span> <span class="n">load</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">PORTB</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">load</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">DDRB</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">sck</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">mosi</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">load</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">SPCR</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">SPE</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">MSTR</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">SPSR</span> <span class="o">|=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// prescale 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">SPI_transmit</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">SPDR</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">SPSR</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">SPIF</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Pada fungsi <code>SPI_transmit</code>, assignment ke variabel <code>SPDR</code> akan mengisi shift register internal dan mengirimkan data ke jalur <code>MOSI</code> secara langsung. Ukuran data pada satu kali transmisi adalah 1 byte. Setelah transmisi selesai, bit <code>SPIF</code> pada <code>SPSR</code> akan berubah menjadi 1.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="SPI Data Register"
    width="1434"
    height="306"
    src="/posts/avr/02-max7219/img/spdr_hu_3985f1fc010a982b.png"
    srcset="/posts/avr/02-max7219/img/spdr_hu_3985f1fc010a982b.png 800w, /posts/avr/02-max7219/img/spdr_hu_880b7c79267ecc8a.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/spdr.png"><figcaption>SPI Data Register</figcaption></figure>

<h3 class="relative group">Registers Map
    <div id="registers-map" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#registers-map" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="Serial Data Format"
    width="1349"
    height="166"
    src="/posts/avr/02-max7219/img/data-format_hu_aa1bc4a5d888d6bc.png"
    srcset="/posts/avr/02-max7219/img/data-format_hu_aa1bc4a5d888d6bc.png 800w, /posts/avr/02-max7219/img/data-format_hu_61b30f11f9380568.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/data-format.png"><figcaption>MAX7219 Serial Data Format</figcaption></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="Address Map"
    width="857"
    height="1062"
    src="/posts/avr/02-max7219/img/address-map_hu_a4745ca0283583c7.png"
    srcset="/posts/avr/02-max7219/img/address-map_hu_a4745ca0283583c7.png 800w, /posts/avr/02-max7219/img/address-map.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/address-map.png"><figcaption>MAX7219 Register Address Map</figcaption></figure>
</p>
<p>Format data instruksi yang diterima MAX7219 berukuran 2 Byte. Byte paling signifikan berisi alamat register yang akan diubah (D8-D11), byte bawah berisi data yang akan ditulis pada register tersebut.</p>
<p>Secara default, MAX7219 berada dalam shutdown mode. Untuk keluar dari shutdown mode pada saat inisialisasi, kita perlu mengirim alamat register shutdown <code>0x0C</code> diikuti dengan mode normal <code>1</code>.
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="Shutdown Register"
    width="1033"
    height="193"
    src="/posts/avr/02-max7219/img/shutdown-register_hu_d99e98e1d647047d.png"
    srcset="/posts/avr/02-max7219/img/shutdown-register_hu_d99e98e1d647047d.png 800w, /posts/avr/02-max7219/img/shutdown-register.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/shutdown-register.png"></figure>
</p>
<p>Pada datasheet MAX7219, nilai data masing-masing register dijelaskan dengan sangat lengkap. Saya tidak akan menampilkan semua tabelnya di sini. Kurang lebih berikut adalah deskripsi singkat masing-masing register:</p>
<ol>
<li><code>No-Op</code>: No Operation, digunakan untuk daisy-chaining.</li>
<li><code>Digit 0-7</code>: Menentukan LED mana saja yang menyala pada tiap-tiap digit.</li>
<li><code>Decode Mode</code>: Untuk mengaktifkan 7-segment decoder pada beberapa digit.</li>
<li><code>Intensity</code>: Mengatur kecerahan dalam skala 0-15.</li>
<li><code>Scan Limit</code>: Menentukan berapa digit yang aktif.</li>
<li><code>Shutdown</code>: Shutdown mode.</li>
<li><code>Display Test</code>: Jika aktif semua LED akan menyala.</li>
</ol>

<h3 class="relative group">Daisy Chaining
    <div id="daisy-chaining" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#daisy-chaining" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Dalam melakukan daisy chaining, hal yang perlu diperhatikan adalah cara kita mengirim instruksi. Mengacu pada datasheet, kita perlu menggunakan instruksi <code>No Operation</code>.</p>
<p>Pada satu kali transmisi instruksi, hanya 1 modul yang mendapat instruksi aktif. Modul lainnya akan mendapat instruksi <code>No-Op</code>. Contoh berikut mengeluarkan tiga modul dari mode shutdown:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Keterangan</th>
          <th style="text-align: left">Modul 1</th>
          <th style="text-align: left">Modul 2</th>
          <th style="text-align: left">Modul 3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Transmisi Pertama</td>
          <td style="text-align: left"><code>0x0C00</code></td>
          <td style="text-align: left"><code>0x0</code></td>
          <td style="text-align: left"><code>0x0</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Transmisi Kedua</td>
          <td style="text-align: left"><code>0x0</code></td>
          <td style="text-align: left"><code>0x0C00</code></td>
          <td style="text-align: left"><code>0x0</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Transmisi Ketiga</td>
          <td style="text-align: left"><code>0x0</code></td>
          <td style="text-align: left"><code>0x0</code></td>
          <td style="text-align: left"><code>0x0C00</code></td>
      </tr>
  </tbody>
</table>

<h3 class="relative group">Initialization
    <div id="initialization" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#initialization" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Untuk melakukan inisialisasi, kita perlu mengetahui terlebih dahulu total modul MAX7219 yang terhubung. Sehingga kita dapat mengirimkan jumlah instruksi <code>No-Op</code> yang tepat.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// register address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define MAX_TEST 0xF
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MAX_SHUTDOWN 0xC
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MAX_SCAN 0xB
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MAX_INTENSITY 0xA
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MAX_MODE 0x9
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">volatile</span> <span class="kt">uint8_t</span> <span class="n">device_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">send_instruction</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">instruction</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">load_pin</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">target_id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">PORTB</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">load_pin</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="n">device_num</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">target_id</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">SPI_transmit</span><span class="p">(</span><span class="mh">0x00</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">SPI_transmit</span><span class="p">(</span><span class="mh">0x00</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">SPI_transmit</span><span class="p">(</span><span class="n">instruction</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">);</span> <span class="c1">// address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">SPI_transmit</span><span class="p">(</span><span class="n">instruction</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span> <span class="c1">// data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">target_id</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">SPI_transmit</span><span class="p">(</span><span class="mh">0x00</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">SPI_transmit</span><span class="p">(</span><span class="mh">0x00</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">PORTB</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">load_pin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">display_init</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">decode_mode</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">scan_limit</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">intensity</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">load_pin</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">total_display</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">device_num</span> <span class="o">=</span> <span class="n">total_display</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">((</span><span class="n">MAX_TEST</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">((</span><span class="n">MAX_SHUTDOWN</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">(((</span><span class="n">MAX_MODE</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">decode_mode</span><span class="p">),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">(((</span><span class="n">MAX_SCAN</span><span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">scan_limit</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">(((</span><span class="n">MAX_INTENSITY</span><span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">intensity</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">)),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">(((</span><span class="n">MAX_SHUTDOWN</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="mi">1</span><span class="p">),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Jumlah device MAX7219 didefinisikan sebagai variabel global sehingga dapat diakses oleh kedua fungsi.</p>
<p>Pada fungsi <code>send_instruction</code>, pin load akan menjadi <code>LOW</code>. Setelah itu instruksi <code>No-Op</code> akan dikirimkan sebelum dan/atau sesudah instruksi utama sesuai kebutuhan. Ketika semua instruksi terkirim, pin load kembali ke posisi <code>HIGH</code> sehingga display akan diperbarui.</p>
<p>Routine <code>display_init</code> akan mengirimkan serangkaian instruksi untuk menginisialisasi display sesuai argumen yang diberikan: <code>decode_mode</code>, <code>scan_limit</code>, <code>intensity</code>, <code>load_pin</code>, <code>id</code>, <code>total_display</code>.</p>

<h2 class="relative group">Show Something
    <div id="show-something" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#show-something" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>MAX7219 disertai dengan <code>Code-B Decoder</code>, ini berguna untuk men-decode bilangan biner 4-bit (0-15) pada register digit ke tampilan 7 segment. Ketika diaktifkan, decoder akan menentukan segmen mana saja (A-G) yang akan menyala.</p>
<p><figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="7 Segment Naming"
    width="684"
    height="366"
    src="/posts/avr/02-max7219/img/7-segment-layout.png"
    srcset="/posts/avr/02-max7219/img/7-segment-layout.png 800w, /posts/avr/02-max7219/img/7-segment-layout.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/7-segment-layout.png"></figure>

<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="Code B Font"
    width="1414"
    height="894"
    src="/posts/avr/02-max7219/img/code-b-font_hu_4365c0b5e00d9c31.png"
    srcset="/posts/avr/02-max7219/img/code-b-font_hu_4365c0b5e00d9c31.png 800w, /posts/avr/02-max7219/img/code-b-font_hu_da36960c801ce456.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/code-b-font.png"></figure>
</p>

<h3 class="relative group">8 Digit 7-Segment LED
    <div id="8-digit-7-segment-led" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#8-digit-7-segment-led" aria-label="Anchor">#</a>
    </span>
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define SCK PB5
</span></span></span><span class="line"><span class="cl"><span class="cp">#define MOSI PB3
</span></span></span><span class="line"><span class="cl"><span class="cp">#define LOAD PB2
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">SPI_init</span><span class="p">(</span><span class="n">SCK</span><span class="p">,</span> <span class="n">MOSI</span><span class="p">,</span> <span class="n">LOAD</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">display_init</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>Modul pertama yang terhubung ke MCU adalah modul 7 segment untuk menampilkan waktu. Pada inisialisasi, <code>0xFF</code> mengaktifkan decoder untuk semua digit, <code>0x07</code> mengatur brightness menjadi 7/15, <code>0</code> karena merupakan perangkat pertama, dan total modul ada <code>2</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">display_codeB</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">digit</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">code</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">load_pin</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">send_instruction</span><span class="p">((((</span><span class="n">digit</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">code</span><span class="p">),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Rutin display_codeB akan mengirim instruksi ke register beralamat <code>digit</code>, sehingga digit terkait menampilkan nilai code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">update_display</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">centiseconds</span> <span class="o">&gt;=</span> <span class="mi">8640000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">centiseconds</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="n">cs</span> <span class="o">=</span> <span class="n">centiseconds</span> <span class="o">%</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">remaining_seconds</span> <span class="o">=</span> <span class="n">centiseconds</span><span class="o">/</span><span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">h</span> <span class="o">=</span> <span class="n">remaining_seconds</span> <span class="o">/</span> <span class="mi">3600</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">m</span> <span class="o">=</span> <span class="n">remaining_seconds</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">%</span> <span class="mi">60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">s</span> <span class="o">=</span> <span class="n">remaining_seconds</span> <span class="o">%</span> <span class="mi">60</span><span class="p">;</span> <span class="c1">// v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">((</span><span class="n">cs</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">cs</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">((</span><span class="n">s</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">((</span><span class="n">m</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">((</span><span class="n">h</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">display_codeB</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nf">display_char</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">update_display</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Pada setiap 10ms, nilai masing-masing satuan (jam, menit, sekon, centisekon) akan dihitung. Proses ini berlangsung singkat, jauh lebih singkat dari 160.000 clock cycle (10ms).</p>

<h3 class="relative group">8x8 LED Matrix
    <div id="8x8-led-matrix" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#8x8-led-matrix" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Untuk display kedua, kita menggunakan modul 8x8 matrix untuk menampilkan beberapa karakter.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">display_init</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span></code></pre></div><p><code>0x00</code> untuk menonaktifkan decoder. Ketika decoder dinonaktifkan, masing-masing register digit akan menentukan satu baris seperti ilustrasi di bawah.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="8x8 Matrix Bytes"
    width="734"
    height="457"
    src="/posts/avr/02-max7219/img/8x8-matrix-bytes.png"
    srcset="/posts/avr/02-max7219/img/8x8-matrix-bytes.png 800w, /posts/avr/02-max7219/img/8x8-matrix-bytes.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/avr/02-max7219/img/8x8-matrix-bytes.png"></figure>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">EMOJI_NUM</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">uint64_t</span> <span class="n">IMAGES</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="mh">0x0800080810202418</span><span class="p">,</span> <span class="c1">// 0 ?
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x8142241818244281</span><span class="p">,</span> <span class="c1">// 1 x
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x1818001818181818</span><span class="p">,</span> <span class="c1">// 2 !
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x040A112040800000</span><span class="p">,</span> <span class="c1">// 3 v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x00183C7EFFFF6600</span><span class="p">,</span> <span class="c1">// 4 heart emoji
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x3C4299A581A5423C</span><span class="p">,</span> <span class="c1">// 5 smile emoji
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x3C42A59981A5423C</span><span class="p">,</span> <span class="c1">// 6 sad face emoji
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x3C4281BD81A5423C</span><span class="p">,</span> <span class="c1">// 7 flat face emoji
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x3c3c1818181e1c18</span><span class="p">,</span> <span class="c1">// 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="mh">0x7e7e1c3060667e3c</span><span class="p">,</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">IMAGES_LEN</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">IMAGES</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">display_char</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">load_pin</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint64_t</span> <span class="n">image</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">image</span> <span class="o">=</span> <span class="n">IMAGES</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="p">((</span><span class="n">image</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">j</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">send_instruction</span><span class="p">((((</span><span class="mi">8</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">d</span><span class="p">),</span> <span class="n">load_pin</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Array <code>IMAGES</code> menyimpan karakter-karakter mulai dari emoji, angka, huruf kapital, dan huruf kecil. Masing-masing elemen berukuran 64-bit, setiap bit-nya menentukan nyala/mati satu buah led pada matrix 8x8. Pada definisi di atas, data disimpan dalam bentuk heksadesimal untuk alasan keringkasan. 2 digit heksadesimal setara dengan 1 byte, 1 baris.</p>
<p>Array gambar penuh dapat diakses pada repository github: <a
  href="https://github.com/vfadlan/avr-exp/tree/main/08-max7219-timer"
    target="_blank"
  >vfadlan/avr-exp/08-max7219-timer</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">display_char</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LOAD</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span></code></pre></div><p>Pemanggilan fungsi di atas akan menampilkan <code>IMAGES[c]</code> pada modul kedua.</p>

<h2 class="relative group">Result
    <div id="result" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#result" aria-label="Anchor">#</a>
    </span>
    
</h2>
<lite-youtube videoid="tb8b-7_S8ds" playlabel="tb8b-7_S8ds" params=""></lite-youtube>


<h2 class="relative group">Conclusion
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#conclusion" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Dalam menggunakan timer, kita perlu melakukan perhitungan untuk mendapat hasil yang presisi. Bahkan hingga ke level nanosecond.</p>
<p>Sejauh ini, kita menggunakan timer untuk debounce tombol, dan menghitung waktu setiap 10ms. Waktu tersebut ditampilkan ke modul 7-segment 8 digit.</p>
<p>Display 7-segment 8 digit dikendarai oleh IC MAX7219 yang menggunakan SPI sebagai protokol komunikasinya. IC tersebut menangani berbagai macam hal seperti multiplexing, 7-segment decoder, daisy-chaining, dll.</p>
<p>Dengan penggunaan IC MAX7219 sebagai driver eksternal, beban kerja CPU berkurang signifikan. Selain itu, ATMega328P dilengkapi dengan peripheral SPI sehingga dapat meringankan pekerjaan CPU dalam proses komunikasi.</p>

<h2 class="relative group">References and Further Reading
    <div id="references-and-further-reading" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#references-and-further-reading" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>GitHub: <a
  href="https://github.com/vfadlan/avr-exp/tree/main/08-max7219-timer"
    target="_blank"
  >vfadlan/avr-exp/08-max7219-timer</a></li>
<li><a
  href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-7810-Automotive-Microcontrollers-ATmega328P_Datasheet.pdf"
    target="_blank"
  >ATMega328P Datasheet</a></li>
<li>[MAX7219 Driver Datasheet]</li>
<li>[AVR1200: Using External Interrupts for megaAVR Devices]</li>
</ul>

          
          
          
        </div>
        
        
  <details class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5">
    
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">
    AVR -
    This article is part of a series.
  </summary>
  
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/avr/00-hello/">
          Part 0:
          Hello, Bare Metal AVR.
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/avr/01-shift-register/">
          Part 1:
          Animating LEDs with Shift Register
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        Part 2:
        This Article
      </div>
    
  


  </details>


        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts/avr/02-max7219/index.md"
          data-oid-likes="likes_posts/avr/02-max7219/index.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/posts/avr/01-shift-register/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Animating LEDs with Shift Register
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2026-01-12T07:00:00&#43;07:00">12 January 2026</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2026
          Fadlan Abduh
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
